SELECT customer.c_customer_id FROM customer JOIN ( SELECT store.s_store_id, AVG(store_returns.sr_return_quantity) AS avg_return_quantity FROM store_returns JOIN store ON store_returns.sr_store_sk = store.s_store_sk JOIN customer_address ON store_returns.sr_addr_sk = customer_address.ca_address_sk JOIN date_dim ON store_returns.sr_returned_date_sk = date_dim.d_date_sk WHERE date_dim.d_year = 2000 AND store.s_state = 'TN' GROUP BY store.s_store_id ) AS avg_returns ON customer.c_customer_sk = store_returns.sr_customer_sk JOIN store ON store_returns.sr_store_sk = store.s_store_sk JOIN customer_address ON store_returns.sr_addr_sk = customer_address.ca_address_sk JOIN date_dim ON store_returns.sr_returned_date_sk = date_dim.d_date_sk WHERE store_returns.sr_return_quantity > (avg_returns.avg_return_quantity * 1.2) ORDER BY customer.c_customer_id ASC
SELECT T3.d_year, sum(T1.ss_ext_sales_price), T2.i_brand_id  FROM store_sales AS T1  JOIN item AS T2 ON T1.ss_item_sk = T2.i_item_sk  JOIN date_dim AS T3 ON T1.ss_sold_date_sk = T3.d_date_sk  WHERE T2.i_manufact_id = 128 AND T3.d_month_seq = 11  GROUP BY T3.d_year, T2.i_brand_id  ORDER BY T3.d_year ASC, sum(T1.ss_ext_sales_price) DESC, T2.i_brand_id ASC
SELECT ca_state  FROM customer_address  WHERE ca_state IN (     SELECT ca_state      FROM customer      WHERE c_first_sales_date_sk IN (         SELECT d_date_sk          FROM date_dim          WHERE d_year = 2001          AND d_month_seq = 120      )     AND c_customer_sk IN (         SELECT cs_bill_customer_sk          FROM catalog_sales          WHERE cs_sales_price > (             SELECT AVG(i_current_price) * 1.2              FROM item              WHERE i_item_sk = cs_item_sk              AND i_category = cs_category          )     ) ) GROUP BY ca_state  HAVING COUNT(DISTINCT c_customer_sk) >= 10  ORDER BY COUNT(DISTINCT c_customer_sk), ca_state ASC
SELECT avg(ss_quantity), avg(ss_list_price), avg(ss_ext_discount_amt), avg(ss_ext_sales_price)  FROM store_sales  JOIN promotion ON store_sales.ss_promo_sk = promotion.p_promo_sk  JOIN item ON item.i_item_sk = store_sales.ss_item_sk  JOIN date_dim ON date_dim.d_date_sk = store_sales.ss_sold_date_sk  JOIN customer_demographics ON customer_demographics.cd_demo_sk = store_sales.ss_cdemo_sk  WHERE date_dim.d_year = 2000  AND promotion.p_channel_dmail != 'mail'  AND promotion.p_channel_event != 'special event'  AND customer_demographics.cd_gender = 'M'  AND customer_demographics.cd_marital_status = 'single'  AND customer_demographics.cd_education_status = 'college-educated'  GROUP BY item.i_item_id  ORDER BY item.i_item_id ASC  LIMIT 100
SELECT CASE      WHEN ss_quantity BETWEEN 1 AND 20 AND ss_quantity > 74129 THEN avg(ss_discount_amt)     ELSE avg(ss_net_paid) END FROM store_sales GROUP BY      CASE          WHEN ss_quantity BETWEEN 1 AND 20 AND ss_quantity > 74129 THEN 'Bucket 1'         WHEN ss_quantity BETWEEN 21 AND 40 AND ss_quantity > 122840 THEN 'Bucket 2'         WHEN ss_quantity BETWEEN 41 AND 60 AND ss_quantity > 56580 THEN 'Bucket 3'         WHEN ss_quantity BETWEEN 61 AND 80 AND ss_quantity > 10097 THEN 'Bucket 4'         WHEN ss_quantity BETWEEN 81 AND 100 AND ss_quantity > 165306 THEN 'Bucket 5'     END
SELECT COUNT(*) AS customer_count,  cd_gender,  cd_marital_status,  cd_education_status,  cd_purchase_estimate,  cd_credit_rating,  cd_dep_count,  cd_dep_employed_count,  cd_dep_college_count FROM customer_demographics cd JOIN customer c ON cd.cd_demo_sk = c.c_current_cdemo_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk JOIN web_sales ws ON c.c_customer_sk = ws.ws_ship_customer_sk JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk AND ws.ws_sold_date_sk = d.d_date_sk JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN web_site ws ON ws.ws_web_site_sk = ws.ws_web_site_sk WHERE ca.ca_county IN ('Rush County', 'Toole County', 'Jefferson County', 'Dona Ana County', 'La Porte County') AND d.d_year = 2002 AND d.d_month IN (1, 2, 3) GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ASC
SELECT T1.i_item_id, T1.i_item_desc, T1.i_category, T1.i_class, T1.i_current_price, SUM(T2.ws_ext_sales_price), SUM(T2.ws_ext_sales_price) / T3.total_sales  FROM item AS T1  JOIN web_sales AS T2 ON T1.i_item_sk = T2.ws_item_sk  JOIN date_dim AS T3 ON T2.ws_sold_date_sk = T3.d_date_sk  WHERE T3.d_date >= '1999-02-22' AND T3.d_date <= DATE('1999-02-22', '+30 days')  AND T1.i_category IN ('Sports', 'Books', 'Home')  GROUP BY T1.i_item_id, T1.i_item_desc, T1.i_category, T1.i_class, T1.i_current_price  ORDER BY T1.i_category ASC, T1.i_class ASC, T1.i_item_id ASC, T1.i_item_desc ASC, SUM(T2.ws_ext_sales_price) / T3.total_sales ASC
SELECT AVG(ss_quantity) AS average_sales_quantity, AVG(ss_sales_price) AS average_sales_price, AVG(ss_wholesale_cost) AS average_wholesale_cost, SUM(ss_wholesale_cost) AS total_wholesale_cost FROM store_sales ss JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE d.d_year = 2001 AND (     (cd.cd_marital_status = 'M' AND cd.cd_education_status = 'Advanced Degree' AND ss.ss_sales_price BETWEEN 100 AND 150)     OR (cd.cd_marital_status = 'S' AND cd.cd_education_status = 'College' AND ss.ss_sales_price BETWEEN 50 AND 100)     OR (cd.cd_marital_status = 'W' AND cd.cd_education_status = '2 yr Degree' AND ss.ss_sales_price BETWEEN 150 AND 200) ) AND (     (ca.ca_state IN ('TX', 'OH') AND ss.ss_net_profit BETWEEN 100 AND 200)     OR (ca.ca_state IN ('OR', 'NM', 'KY') AND ss.ss_net_profit BETWEEN 150 AND 300)     OR (ca.ca_state IN ('VA', 'TX', 'MS') AND ss.ss_net_profit BETWEEN 50 AND 250) )
SELECT sum(T1.cs_sales_price)  FROM catalog_sales AS T1  JOIN date_dim AS T2 ON T1.cs_sold_date_sk = T2.d_date_sk  JOIN customer AS T3 ON T1.cs_bill_customer_sk = T3.c_customer_sk  JOIN customer_address AS T4 ON T3.c_current_addr_sk = T4.ca_address_sk  WHERE T1.cs_sales_price > 500      OR T3.c_state IN ('CA', 'WA', 'GA')      OR SUBSTR(T4.ca_zip, 1, 5) IN ('85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792')      AND T2.d_quarter_seq = 2      AND T2.d_year = 2001  ORDER BY T4.ca_zip ASC
SELECT DISTINCT cs_order_number, SUM(cs_ext_ship_cost), SUM(cs_net_profit)  FROM catalog_sales AS T1  JOIN customer_address AS T2 ON T1.cs_ship_addr_sk = T2.ca_address_sk  JOIN date_dim AS T3 ON T1.cs_sold_date_sk = T3.d_date_sk  WHERE T2.ca_county = 'Williamson County'  AND T2.ca_state = 'GA'  AND T3.d_date >= '2002-02-01'  AND T3.d_date <= '2002-04-01'  AND T1.cs_returned_date_sk IS NULL  AND T1.cs_warehouse_sk != 1  GROUP BY cs_order_number  ORDER BY cs_order_number ASC
SELECT sum(T1.ss_sales_price) ,  T2.i_brand ,  T2.i_item_id ,  T2.i_manufact ,  T2.i_manufact_id  FROM store_sales AS T1  JOIN item AS T2 ON T1.ss_item_sk  =  T2.i_item_sk  JOIN store AS T3 ON T1.ss_store_sk  =  T3.s_store_sk  JOIN date_dim AS T4 ON T1.ss_sold_date_sk  =  T4.d_date_sk  JOIN customer AS T5 ON T1.ss_customer_sk  =  T5.c_customer_sk  JOIN customer_address AS T6 ON T5.c_current_addr_sk  =  T6.ca_address_sk  JOIN household_demographics AS T7 ON T5.c_current_hdemo_sk  =  T7.hd_demo_sk  JOIN customer_demographics AS T8 ON T5.c_current_cdemo_sk  =  T8.cd_demo_sk  JOIN promotion AS T9 ON T1.ss_promo_sk  =  T9.p_promo_sk  WHERE T3.s_manager  =  11  AND T4.d_month_seq  =  8  AND T4.d_year  =  1998  AND T6.ca_zip  !=  T3.s_zip  GROUP BY T1.ss_item_sk ,  T2.i_brand ,  T2.i_item_id ,  T2.i_manufact ,  T2.i_manufact_id  ORDER BY sum(T1.ss_sales_price) DESC ,  T2.i_brand ASC ,  T2.i_item_id ASC ,  T2.i_manufact_id ASC ,  T2.i_manufact ASC
SELECT item.i_item_id, item.i_item_desc, item.i_category, item.i_class_id, item.i_current_price, SUM(store_sales.ss_sales_price) AS total_revenue, SUM(store_sales.ss_sales_price) / SUM(store_sales.ss_sales_price) OVER (PARTITION BY item.i_class_id) AS revenue_ratio  FROM store_sales  JOIN item ON store_sales.ss_item_sk = item.i_item_sk  JOIN date_dim ON date_dim.d_date_sk = store_sales.ss_sold_date_sk  WHERE item.i_category IN ('Sports', 'Books', 'Home')  AND date_dim.d_date >= '1999-02-22'  AND date_dim.d_date <= '1999-03-23'  GROUP BY item.i_item_id, item.i_item_desc, item.i_category, item.i_class_id, item.i_current_price  ORDER BY item.i_category, item.i_class_id, item.i_item_id, item.i_item_desc, revenue_ratio
SELECT T3.w_warehouse_name, T1.i_item_id,  ((SUM(CASE WHEN T2.inv_date_sk < (SELECT d_date_sk FROM date_dim WHERE d_date = '2000-03-11') - 30 THEN T2.inv_quantity_on_hand ELSE 0 END)) /  (SUM(CASE WHEN T2.inv_date_sk > (SELECT d_date_sk FROM date_dim WHERE d_date = '2000-03-11') + 30 THEN T2.inv_quantity_on_hand ELSE 0 END))) AS percentage_rate_in_inventory  FROM item AS T1  JOIN inventory AS T2 ON T2.inv_item_sk = T1.i_item_sk  JOIN warehouse AS T3 ON T2.inv_warehouse_sk = T3.w_warehouse_sk  WHERE T1.i_rec_end_date > (SELECT d_date FROM date_dim WHERE d_date = '2000-03-11')  AND T1.i_rec_start_date < (SELECT d_date FROM date_dim WHERE d_date = '2000-03-11')  GROUP BY T3.w_warehouse_name, T1.i_item_id  ORDER BY T3.w_warehouse_name, T1.i_item_id ASC
SELECT i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name, SUM(ss.ss_net_profit) AS store_net_profit, SUM(sr.sr_net_loss) AS store_net_loss, SUM(cr.cr_net_profit) AS catalog_net_profit FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN store_returns sr ON ss.ss_ticket_number = sr.sr_ticket_number JOIN catalog_returns cr ON sr.sr_item_sk = cr.cr_item_sk WHERE ss.ss_sold_date_sk >= 2452022 AND ss.ss_sold_date_sk <= 2452281 AND sr.sr_returned_date_sk >= 2452022 AND sr.sr_returned_date_sk <= 2452881 AND cr.cr_returned_date_sk >= 2452022 AND cr.cr_returned_date_sk <= 2452881 GROUP BY i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name ORDER BY i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name
SELECT item.i_item_id, avg(catalog_sales.cs_quantity), avg(catalog_sales.cs_list_price), avg(catalog_sales.cs_ext_discount_amt), avg(catalog_sales.cs_ext_sales_price)  FROM catalog_sales  JOIN promotion ON catalog_sales.cs_promo_sk = promotion.p_promo_sk  JOIN item ON catalog_sales.cs_item_sk = item.i_item_sk  JOIN customer_demographics ON catalog_sales.cs_bill_cdemo_sk = customer_demographics.cd_demo_sk  JOIN customer ON catalog_sales.cs_bill_customer_sk = customer.c_customer_sk  WHERE promotion.p_channel_dmail = 0  AND promotion.p_channel_event = 0  AND customer_demographics.cd_education_status = 'college-educated'  AND customer_demographics.cd_gender = 'M'  GROUP BY item.i_item_id  ORDER BY item.i_item_id ASC
SELECT avg(ss_list_price) ,  count(ss_list_price) ,  count(distinct ss_list_price)  FROM store_sales  WHERE  (quantity BETWEEN 0 AND 5 AND ss_list_price BETWEEN 8 AND 18 AND coupon_amt BETWEEN 459 AND 1459 AND ss_wholesale_cost BETWEEN 57 AND 77)  OR  (quantity BETWEEN 6 AND 10 AND ss_list_price BETWEEN 90 AND 100 AND coupon_amt BETWEEN 2323 AND 3323 AND ss_wholesale_cost BETWEEN 31 AND 51)  OR  (quantity BETWEEN 11 AND 15 AND ss_list_price BETWEEN 142 AND 152 AND coupon_amt BETWEEN 12214 AND 13214 AND ss_wholesale_cost BETWEEN 79 AND 99)  OR  (quantity BETWEEN 16 AND 20 AND ss_list_price BETWEEN 135 AND 145 AND coupon_amt BETWEEN 6071 AND 7071 AND ss_wholesale_cost BETWEEN 38 AND 58)  OR  (quantity BETWEEN 21 AND 25 AND ss_list_price BETWEEN 122 AND 132 AND coupon_amt BETWEEN 836 AND 1836 AND ss_wholesale_cost BETWEEN 17 AND 37)  OR  (quantity BETWEEN 26 AND 30 AND ss_list_price BETWEEN 154 AND 164 AND coupon_amt BETWEEN 7326 AND 8326 AND ss_wholesale_cost BETWEEN 7 AND 27)
SELECT i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name, SUM(ss.ss_quantity) AS total_quantity_sold, SUM(sr.sr_return_quantity) AS total_quantity_returned, SUM(cs.cs_quantity) AS total_quantity_purchased FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN store_returns sr ON ss.ss_ticket_number = sr.sr_ticket_number JOIN catalog_sales cs ON sr.sr_item_sk = cs.cs_item_sk WHERE ss.ss_sold_date_sk >= (SELECT d_date_sk FROM date_dim WHERE d_year = 1999 AND d_month_seq = 199909) AND ss.ss_sold_date_sk <= (SELECT d_date_sk FROM date_dim WHERE d_year = 1999 AND d_month_seq = 199912) AND sr.sr_returned_date_sk >= (SELECT d_date_sk FROM date_dim WHERE d_year = 1999 AND d_month_seq = 200001) AND sr.sr_returned_date_sk <= (SELECT d_date_sk FROM date_dim WHERE d_year = 2002 AND d_month_seq = 200212) AND cs.cs_sold_date_sk >= (SELECT d_date_sk FROM date_dim WHERE d_year = 2002 AND d_month_seq = 200301) AND cs.cs_sold_date_sk <= (SELECT d_date_sk FROM date_dim WHERE d_year = 2004 AND d_month_seq = 200412) GROUP BY i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name ORDER BY i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name
SELECT T1.c_customer_id, T1.c_salutation, T1.c_first_name, T1.c_last_name, T1.c_preferred_cust_flag, T1.c_birth_day, T1.c_birth_month, T1.c_birth_year, T1.c_birth_country, T1.c_login, T1.c_email_address, T1.c_last_review_date_sk, SUM(T2.wr_return_amt)  FROM customer AS T1  JOIN web_returns AS T2 ON T1.c_customer_sk = T2.wr_returning_customer_sk  JOIN date_dim AS T3 ON T2.wr_returned_date_sk = T3.d_date_sk  WHERE T3.d_year = 2002 AND T3.d_state = 'GA' AND T2.wr_return_amt > 1.2 * (SELECT AVG(T4.wr_return_amt)                                                                          FROM web_returns AS T4                                                                          JOIN date_dim AS T5 ON T4.wr_returned_date_sk = T5.d_date_sk                                                                          WHERE T5.d_year = 2002 AND T5.d_state = 'GA')  GROUP BY T1.c_customer_id, T1.c_salutation, T1.c_first_name, T1.c_last_name, T1.c_preferred_cust_flag, T1.c_birth_day, T1.c_birth_month, T1.c_birth_year, T1.c_birth_country, T1.c_login, T1.c_email_address, T1.c_last_review_date_sk  ORDER BY T1.c_customer_id
SELECT sum(cs_ext_discount_amt)  FROM catalog_sales  JOIN item ON catalog_sales.cs_item_sk = item.i_item_sk  JOIN date_dim ON catalog_sales.cs_sold_date_sk = date_dim.d_date_sk  WHERE item.i_manufact_id = 977  AND date_dim.d_date >= '2000-01-27'  AND date_dim.d_date <= '2000-04-26'  AND catalog_sales.cs_ext_discount_amt > 1.3 * (SELECT avg(cs_ext_discount_amt) FROM catalog_sales)
SELECT item.i_manufact_id , sum(store_sales.ss_ext_sales_price) + sum(catalog_sales.cs_ext_sales_price) + sum(web_sales.ws_ext_sales_price) AS monthly_sales  FROM store_sales  JOIN item ON store_sales.ss_item_sk = item.i_item_sk  JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk  JOIN store ON store_sales.ss_store_sk = store.s_store_sk  JOIN catalog_sales ON catalog_sales.cs_item_sk = item.i_item_sk  JOIN web_sales ON web_sales.ws_item_sk = item.i_item_sk  JOIN web_site ON web_sales.ws_web_site_sk = web_site.web_site_sk  WHERE date_dim.d_month_seq = 5  AND date_dim.d_year = 1998  AND item.i_category_id = 'Electronics'  AND (store.s_gmt_offset = -5 OR web_site.web_gmt_offset = -5)  GROUP BY item.i_manufact_id  ORDER BY monthly_sales DESC
SELECT c_customer_sk, c_customer_id, c_current_cdemo_sk, c_current_hdemo_sk, c_current_addr_sk, c_first_shipto_date_sk, c_first_sales_date_sk, c_salutation, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_day, c_birth_month, c_birth_year, c_birth_country, c_login, c_email_address, c_last_review_date_sk FROM customer WHERE c_customer_sk IN (     SELECT ss_customer_sk     FROM store_sales     JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk     WHERE (d_day_name >= '1' AND d_day_name <= '3') OR (d_day_name >= '25' AND d_day_name <= '28')     AND ss_quantity >= 15 AND ss_quantity <= 20 ) AND c_customer_sk IN (     SELECT hd_demo_sk     FROM household_demographics     WHERE hd_dep_count / hd_vehicle_count > 1.2 ) AND c_customer_sk IN (     SELECT cd_demo_sk     FROM customer_demographics     WHERE cd_buy_potential = '>10000' OR cd_buy_potential = 'Unknown' ) AND c_customer_sk IN (     SELECT s_store_sk     FROM store     WHERE s_country = 'Williamson County' ) AND c_customer_sk IN (     SELECT d_date_sk     FROM date_dim     WHERE d_year >= 1999 AND d_year <= 2001 ) ORDER BY c_last_name ASC, c_first_name ASC, c_salutation ASC, c_preferred_cust_flag DESC, ss_ticket_number DESC
SELECT c_state AS state, cd_gender AS gender, cd_marital_status AS marital_status, COUNT(DISTINCT c_customer_sk) AS customer_count, MIN(cd_dep_count) AS min_dependent_count, MAX(cd_dep_count) AS max_dependent_count, AVG(cd_dep_count) AS avg_dependent_count, COUNT(DISTINCT cd_dep_count) AS distinct_dependent_count, MIN(cd_dep_employed_count) AS min_employed_dependent_count, MAX(cd_dep_employed_count) AS max_employed_dependent_count, AVG(cd_dep_employed_count) AS avg_employed_dependent_count, COUNT(DISTINCT cd_dep_employed_count) AS distinct_employed_dependent_count, MIN(cd_dep_college_count) AS min_college_dependent_count, MAX(cd_dep_college_count) AS max_college_dependent_count, AVG(cd_dep_college_count) AS avg_college_dependent_count, COUNT(DISTINCT cd_dep_college_count) AS distinct_college_dependent_count FROM customer JOIN customer_demographics ON customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk JOIN household_demographics ON customer.c_current_hdemo_sk = household_demographics.hd_demo_sk JOIN store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk WHERE date_dim.d_year = 2002 GROUP BY c_state, cd_gender, cd_marital_status ORDER BY c_state, cd_gender, cd_marital_status, distinct_dependent_count, distinct_employed_dependent_count, distinct_college_dependent_count
SELECT T1.i_item_id, T1.i_item_desc, T1.i_current_price  FROM item AS T1  JOIN inventory AS T2 ON T1.i_item_sk = T2.inv_item_sk  JOIN date_dim AS T3 ON T2.inv_date_sk = T3.d_date_sk  JOIN manufacturer AS T4 ON T1.i_manufact_id = T4.m_manufact_id  WHERE T1.i_manufact_id IN (677, 940, 808)  AND T1.i_current_price BETWEEN 68 AND 98  AND T2.inv_quantity_on_hand BETWEEN 100 AND 500  AND T3.d_date >= '2000-02-01'  AND T3.d_date < '2000-04-01'  ORDER BY T1.i_item_id ASC
SELECT T1.i_category_id, SUM(T2.ss_ext_sales_price)  FROM item AS T1  JOIN store_sales AS T2 ON T1.i_item_sk = T2.ss_item_sk  JOIN date_dim AS D ON T2.ss_sold_date_sk = D.d_date_sk  WHERE D.d_date >= '2000-11-01' AND D.d_date <= '2000-11-30'  GROUP BY T1.i_category_id  ORDER BY SUM(T2.ss_ext_sales_price) DESC, T1.i_category_id ASC
SELECT store.s_store_name, store.s_store_id,  SUM(CASE WHEN date_dim.d_day_name = 'Sunday' THEN store_sales.ss_sales_price ELSE 0 END) AS sunday_sales,  SUM(CASE WHEN date_dim.d_day_name = 'Monday' THEN store_sales.ss_sales_price ELSE 0 END) AS monday_sales,  SUM(CASE WHEN date_dim.d_day_name = 'Tuesday' THEN store_sales.ss_sales_price ELSE 0 END) AS tuesday_sales,  SUM(CASE WHEN date_dim.d_day_name = 'Wednesday' THEN store_sales.ss_sales_price ELSE 0 END) AS wednesday_sales,  SUM(CASE WHEN date_dim.d_day_name = 'Thursday' THEN store_sales.ss_sales_price ELSE 0 END) AS thursday_sales,  SUM(CASE WHEN date_dim.d_day_name = 'Friday' THEN store_sales.ss_sales_price ELSE 0 END) AS friday_sales,  SUM(CASE WHEN date_dim.d_day_name = 'Saturday' THEN store_sales.ss_sales_price ELSE 0 END) AS saturday_sales  FROM store  JOIN date_dim ON store.s_closed_date_sk = date_dim.d_date_sk  JOIN store_sales ON store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_store_sk = store.s_store_sk  WHERE store.s_gmt_offset = -5 AND date_dim.d_year = 2000  GROUP BY store.s_store_name, store.s_store_id  ORDER BY store.s_store_name ASC, store.s_store_id ASC
SELECT sum(ws_sales_price)  FROM web_sales AS T1  JOIN date_dim AS T2 ON T1.ws_sold_date_sk = T2.d_date_sk  JOIN customer AS T3 ON T1.ws_customer_sk = T3.c_customer_sk  JOIN customer_address AS T4 ON T3.c_current_addr_sk = T4.ca_address_sk  JOIN item AS T5 ON T1.ws_item_sk = T5.i_item_sk  WHERE T2.d_quarter_seq = 2  AND T2.d_year = 2001  AND (T4.ca_zip LIKE '85669%' OR T4.ca_zip LIKE '86197%' OR T4.ca_zip LIKE '88274%' OR T4.ca_zip LIKE '83405%' OR T4.ca_zip LIKE '86475%' OR T4.ca_zip LIKE '85392%' OR T4.ca_zip LIKE '85460%' OR T4.ca_zip LIKE '80348%' OR T4.ca_zip LIKE '81792%')  AND (T5.i_item_sk IN (2, 3, 5, 7, 11, 13, 17, 19, 23, 29))
SELECT customer.c_last_name , customer.c_first_name , customer_address.ca_city , store.s_city , store_sales.ss_ticket_number , store_sales.ss_coupon_amt , store_sales.ss_net_profit  FROM customer  JOIN customer_demographics ON customer.c_customer_sk = customer_demographics.cd_demo_sk  JOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk  JOIN store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk  JOIN store ON store.s_store_sk = store_sales.ss_store_sk  JOIN date_dim ON date_dim.d_date_sk = store_sales.ss_sold_date_sk  JOIN time_dim ON time_dim.t_time_sk = store_sales.ss_sold_time_sk  WHERE customer_demographics.cd_dep_count = 4  AND customer_demographics.cd_vehicle_count = 3  AND store.s_city IN ('Midway' , 'Fairview')  AND date_dim.d_year IN (1999 , 2000 , 2001)  AND date_dim.d_weekend = 'Y'  ORDER BY customer.c_last_name , customer.c_first_name , store.s_city , customer_address.ca_city , store_sales.ss_ticket_number ASC
SELECT customer.c_customer_id,     CASE         WHEN customer_demographics.cd_marital_status = 'M' AND customer_demographics.cd_education_status = '4 yr Degree' AND store_sales.ss_sales_price BETWEEN 100 AND 150 THEN 'Married'         WHEN customer_demographics.cd_marital_status = 'D' AND customer_demographics.cd_education_status = '2 yr Degree' AND store_sales.ss_sales_price BETWEEN 50 AND 100 THEN 'Divorced'         WHEN customer_demographics.cd_marital_status = 'S' AND customer_demographics.cd_education_status = 'College' AND store_sales.ss_sales_price BETWEEN 150 AND 200 THEN 'Single'         ELSE 'Other'     END AS customer_type,     store.s_state,     SUM(store_sales.ss_sales_price) AS total_sales,     store_sales.ss_net_profit FROM     store_sales JOIN     customer ON store_sales.ss_customer_sk = customer.c_customer_sk JOIN     customer_demographics ON customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk JOIN     store ON store_sales.ss_store_sk = store.s_store_sk WHERE     store_sales.ss_sold_date_sk IN (         SELECT             d_date_sk         FROM             date_dim         WHERE             d_year = 2000     )     AND customer.c_birth_country = 'United States'     AND (         (store.s_state IN ('CO', 'OH', 'TX') AND store_sales.ss_net_profit BETWEEN 0 AND 2000)         OR (store.s_state IN ('OR', 'MN', 'KY') AND store_sales.ss_net_profit BETWEEN 150 AND 3000)         OR (store.s_state IN ('VA', 'CA', 'MS') AND store_sales.ss_net_profit BETWEEN 50 AND 25000)     ) GROUP BY     customer.c_customer_id,     customer_demographics.cd_marital_status,     customer_demographics.cd_education_status,     store.s_state,     store_sales.ss_net_profit
SELECT T1.s_store_id,   SUM(CASE WHEN T2.sr_returned_date_sk - T3.ss_sold_date_sk > 120 THEN T3.ss_quantity ELSE 0 END) AS more_than_120,   SUM(CASE WHEN T2.sr_returned_date_sk - T3.ss_sold_date_sk > 90 AND T2.sr_returned_date_sk - T3.ss_sold_date_sk <= 120 THEN T3.ss_quantity ELSE 0 END) AS "120",   SUM(CASE WHEN T2.sr_returned_date_sk - T3.ss_sold_date_sk > 60 AND T2.sr_returned_date_sk - T3.ss_sold_date_sk <= 90 THEN T3.ss_quantity ELSE 0 END) AS "90",   SUM(CASE WHEN T2.sr_returned_date_sk - T3.ss_sold_date_sk > 30 AND T2.sr_returned_date_sk - T3.ss_sold_date_sk <= 60 THEN T3.ss_quantity ELSE 0 END) AS "60",   SUM(CASE WHEN T2.sr_returned_date_sk - T3.ss_sold_date_sk <= 30 THEN T3.ss_quantity ELSE 0 END) AS "30" FROM store_sales AS T3 JOIN store_returns AS T2 ON T3.ss_ticket_number = T2.sr_ticket_number   AND T3.ss_item_sk = T2.sr_item_sk   AND T3.ss_customer_sk = T2.sr_customer_sk   AND T3.ss_cdemo_sk = T2.sr_cdemo_sk   AND T3.ss_hdemo_sk = T2.sr_hdemo_sk   AND T3.ss_addr_sk = T2.sr_addr_sk   AND T3.ss_store_sk = T2.sr_store_sk JOIN store AS T1 ON T3.ss_store_sk = T1.s_store_sk WHERE T3.ss_sold_date_sk >= 20010801   AND T3.ss_sold_date_sk < 20010901   AND T2.sr_returned_date_sk IS NOT NULL GROUP BY T1.s_store_id
SELECT T2.i_brand_id, SUM(T1.ss_sales_price)  FROM store_sales AS T1  JOIN item AS T2 ON T1.ss_item_sk = T2.i_item_sk  JOIN store AS T3 ON T1.ss_store_sk = T3.s_store_sk  JOIN date_dim AS T4 ON T1.ss_sold_date_sk = T4.d_date_sk  WHERE T3.s_manager = 28  AND T4.d_year = 1999  AND T4.d_month_seq = 11  GROUP BY T2.i_brand_id  ORDER BY SUM(T1.ss_sales_price) DESC, T2.i_brand_id ASC
SELECT T1.i_item_id, SUM(T2.ss_ext_sales_price + T3.cs_ext_sales_price + T4.ws_ext_sales_price) AS monthly_sales_amount FROM store_sales AS T2 JOIN date_dim AS T5 ON T2.ss_sold_date_sk = T5.d_date_sk JOIN item AS T1 ON T2.ss_item_sk = T1.i_item_sk JOIN customer AS T6 ON T2.ss_customer_sk = T6.c_customer_sk JOIN customer_address AS T7 ON T6.c_current_addr_sk = T7.ca_address_sk JOIN catalog_sales AS T3 ON T3.cs_sold_date_sk = T5.d_date_sk AND T3.cs_item_sk = T1.i_item_sk AND T3.cs_customer_sk = T6.c_customer_sk AND T3.cs_ship_addr_sk = T7.ca_address_sk JOIN web_sales AS T4 ON T4.ws_sold_date_sk = T5.d_date_sk AND T4.ws_item_sk = T1.i_item_sk AND T4.ws_customer_sk = T6.c_customer_sk AND T4.ws_ship_addr_sk = T7.ca_address_sk WHERE T5.d_month_seq = 199809 AND T1.i_category = 'Music' AND T7.ca_gmt_offset = -5 GROUP BY T1.i_item_id ORDER BY T1.i_item_id, monthly_sales_amount ASC
SELECT SUM(CASE WHEN T1.promo_sk IS NOT NULL THEN T1.sales_price ELSE 0 END) AS promotion_sales,  SUM(T1.sales_price) AS total_sales,  (SUM(CASE WHEN T1.promo_sk IS NOT NULL THEN T1.sales_price ELSE 0 END) / SUM(T1.sales_price)) AS ratio  FROM (     SELECT T2.sales_price, T2.promo_sk      FROM store_sales AS T2      JOIN date_dim AS T3 ON T2.ss_sold_date_sk = T3.d_date_sk      JOIN item AS T4 ON T2.ss_item_sk = T4.i_item_sk      JOIN customer AS T5 ON T2.ss_customer_sk = T5.c_customer_sk      JOIN customer_address AS T6 ON T5.c_current_addr_sk = T6.ca_address_sk      WHERE T3.d_month_seq = 11      AND T3.d_year = 1998      AND T4.i_category = 'Jewelry'      AND T6.ca_gmt_offset = -5 ) AS T1  GROUP BY T1.promo_sk  ORDER BY promotion_sales ASC, total_sales ASC
SELECT T4.w_warehouse_name, T5.sm_type, T6.web_name,  count(CASE WHEN T2.d_year = 2000 AND julianday(T1.ws_ship_date) - julianday(T2.d_date) <= 30 THEN 1 ELSE NULL END) AS "30_days", count(CASE WHEN T2.d_year = 2000 AND julianday(T1.ws_ship_date) - julianday(T2.d_date) > 30 AND julianday(T1.ws_ship_date) - julianday(T2.d_date) <= 60 THEN 1 ELSE NULL END) AS "31_to_60_days", count(CASE WHEN T2.d_year = 2000 AND julianday(T1.ws_ship_date) - julianday(T2.d_date) > 60 AND julianday(T1.ws_ship_date) - julianday(T2.d_date) <= 90 THEN 1 ELSE NULL END) AS "61_to_90_days", count(CASE WHEN T2.d_year = 2000 AND julianday(T1.ws_ship_date) - julianday(T2.d_date) > 90 AND julianday(T1.ws_ship_date) - julianday(T2.d_date) <= 120 THEN 1 ELSE NULL END) AS "91_to_120_days", count(CASE WHEN T2.d_year = 2000 AND julianday(T1.ws_ship_date) - julianday(T2.d_date) > 120 THEN 1 ELSE NULL END) AS "over_120_days" FROM web_sales AS T1 JOIN date_dim AS T2 ON T1.ws_ship_date_sk = T2.d_date_sk JOIN warehouse AS T4 ON T1.ws_warehouse_sk = T4.w_warehouse_sk JOIN ship_mode AS T5 ON T1.ws_ship_mode_sk = T5.sm_ship_mode_sk JOIN web_site AS T6 ON T1.ws_web_site_sk = T6.web_site_sk GROUP BY T4.w_warehouse_name, T5.sm_type, T6.web_name ORDER BY T4.w_warehouse_name ASC, T5.sm_type, T6.web_name
SELECT T4.s_manager, MONTH(T2.ss_sold_date_sk), SUM(T2.ss_quantity * T2.ss_sales_price)  FROM store_sales AS T2  JOIN item AS T3 ON T2.ss_item_sk = T3.i_item_sk  JOIN store AS T4 ON T2.ss_store_sk = T4.s_store_sk  WHERE strftime('%Y', T2.ss_sold_date_sk) = '2000'  AND T3.i_category IN ('Books', 'Children', 'Electronics')  AND T3.i_class IN ('personal', 'portable', 'reference', 'self-help')  AND T3.i_brand IN ('scholaramalgamalg #14', 'scholaramalgamalg #7', 'exportiunivamalg #9','scholaramalgamalg #9')  GROUP BY T4.s_manager, MONTH(T2.ss_sold_date_sk)  ORDER BY T4.s_manager ASC, SUM(T2.ss_quantity * T2.ss_sales_price) ASC
SELECT T4.s_store_name, T2.i_item_desc, T2.i_current_price  FROM store_sales AS T1  JOIN item AS T2 ON T1.ss_item_sk = T2.i_item_sk  JOIN date_dim AS T3 ON T1.ss_sold_date_sk = T3.d_date_sk  JOIN store AS T4 ON T1.ss_store_sk = T4.s_store_sk  WHERE T3.d_year = 2000  AND T1.ss_ext_sales_price < 0.1 * (SELECT avg(T1.ss_ext_sales_price)                                      FROM store_sales AS T1                                      JOIN date_dim AS T3 ON T1.ss_sold_date_sk = T3.d_date_sk                                      WHERE T3.d_year = 2000)  GROUP BY T4.s_store_name, T2.i_item_desc, T2.i_current_price  ORDER BY T4.s_store_name ASC, T2.i_item_desc ASC
SELECT customer.c_last_name, store_sales.ss_ticket_number,  sum(store_sales.ss_ext_sales_price), sum(store_sales.ss_ext_list_price), sum(store_sales.ss_ext_tax)  FROM store_sales  JOIN store ON store_sales.ss_store_sk = store.s_store_sk  JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk  JOIN customer ON store_sales.ss_customer_sk = customer.c_customer_sk  JOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk  JOIN household_demographics ON customer.c_current_hdemo_sk = household_demographics.hd_demo_sk  JOIN customer_demographics ON customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk  JOIN time_dim ON store_sales.ss_sold_time_sk = time_dim.t_time_sk  JOIN promotion ON store_sales.ss_promo_sk = promotion.p_promo_sk  JOIN item ON store_sales.ss_item_sk = item.i_item_sk  WHERE (store.s_city = 'Fairview' OR store.s_city = 'Midway')  AND (date_dim.d_day_name = 'day 1' OR date_dim.d_day_name = 'day 2')  AND date_dim.d_year >= 1999 AND date_dim.d_year <= 2001  AND (customer_demographics.cd_dep_count = 4 OR customer_demographics.cd_vehicle_count = 3)  GROUP BY customer.c_last_name, store_sales.ss_ticket_number  ORDER BY customer.c_last_name ASC, store_sales.ss_ticket_number ASC
SELECT COUNT(DISTINCT T1.c_customer_id)  FROM customer AS T1  JOIN customer_demographics AS T2 ON T1.c_current_cdemo_sk = T2.cd_demo_sk  JOIN customer_address AS T3 ON T1.c_current_addr_sk = T3.ca_address_sk  JOIN store_sales AS T4 ON T1.c_customer_sk = T4.ss_customer_sk  JOIN date_dim AS T5 ON T4.ss_sold_date_sk = T5.d_date_sk  WHERE T1.c_gender = 'gender'  AND T1.c_marital_status = 'marital_status'  AND T2.cd_education_status = 'education_status'  AND T2.cd_purchase_estimate = 'purchase_estimate'  AND T2.cd_credit_rating = 'credit_rating'  AND T3.ca_state IN ('KY', 'GA', 'NM')  AND T5.d_month_seq BETWEEN 4 AND 6  AND T5.d_year = 2001  AND T4.ss_catalog_page_sk IS NULL  AND T4.ss_web_page_sk IS NULL  GROUP BY T1.c_gender, T1.c_marital_status, T2.cd_education_status, T2.cd_purchase_estimate, T2.cd_credit_rating  ORDER BY T1.c_gender, T1.c_marital_status, T2.cd_education_status, T2.cd_purchase_estimate, T2.cd_credit_rating ASC
SELECT item.i_brand_id, SUM(   CASE     WHEN time_dim.t_shift = 'AM' AND time_dim.t_hour >= 6 AND time_dim.t_hour < 12 THEN store_sales.ss_ext_sales_price     WHEN time_dim.t_shift = 'PM' AND time_dim.t_hour >= 18 AND time_dim.t_hour < 24 THEN store_sales.ss_ext_sales_price     ELSE 0   END ) AS total_ext_price FROM store_sales JOIN time_dim ON store_sales.ss_sold_time_sk = time_dim.t_time_sk JOIN item ON store_sales.ss_item_sk = item.i_item_sk JOIN store ON store_sales.ss_store_sk = store.s_store_sk WHERE time_dim.t_month_seq = 132 AND time_dim.t_year = 1999 AND store.s_manager = '1' GROUP BY item.i_brand_id ORDER BY total_ext_price DESC, item.i_brand_id ASC
SELECT count(customer.c_customer_id)  FROM customer  JOIN customer_demographics ON customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk  JOIN household_demographics ON customer.c_current_hdemo_sk = household_demographics.hd_demo_sk  JOIN store_sales ON customer.c_customer_sk = store_sales.ss_customer_sk  JOIN store ON store_sales.ss_store_sk = store.s_store_sk  JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk  WHERE (customer_demographics.cd_buy_potential = '>10000' OR customer_demographics.cd_buy_potential = 'Unknown')  AND (household_demographics.hd_dep_count/household_demographics.hd_vehicle_count) > 1  AND store.s_county IN ('Williamson County', 'Franklin Parish', 'Bronx County', 'Orange County')  AND store_sales.ss_quantity BETWEEN 1 AND 5  AND date_dim.d_day_name IN ('Monday', 'Tuesday')  AND date_dim.d_dom <= 2  AND date_dim.d_year BETWEEN 1999 AND 2001  GROUP BY customer.c_customer_id  ORDER BY count(customer.c_customer_id) DESC, customer.c_last_name ASC
SELECT customer.c_customer_id, SUM(catalog_returns.cr_return_quantity)  FROM catalog_returns  JOIN customer ON catalog_returns.cr_returning_customer_sk = customer.c_customer_sk  JOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk  JOIN date_dim ON catalog_returns.cr_returned_date_sk = date_dim.d_date_sk  WHERE customer_address.ca_state = 'GA' AND date_dim.d_year = 2000  GROUP BY customer.c_customer_id  HAVING SUM(catalog_returns.cr_return_quantity) > 0.2 * (SELECT AVG(catalog_returns.cr_return_quantity)                                                       FROM catalog_returns                                                       JOIN customer ON catalog_returns.cr_returning_customer_sk = customer.c_customer_sk                                                       JOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk                                                       JOIN date_dim ON catalog_returns.cr_returned_date_sk = date_dim.d_date_sk                                                       WHERE customer_address.ca_state = 'GA' AND date_dim.d_year = 2000)  ORDER BY customer.c_customer_id ASC
SELECT item.i_item_id, item.i_item_desc, item.i_current_price  FROM item  JOIN inventory ON item.i_item_sk = inventory.inv_item_sk  JOIN date_dim ON inventory.inv_date_sk = date_dim.d_date_sk  WHERE item.i_manufact_id IN (129, 270, 821, 423)  AND item.i_current_price BETWEEN 62 AND 92  AND inventory.inv_quantity_on_hand BETWEEN 100 AND 500  AND date_dim.d_date BETWEEN '2000-05-25' AND DATE('2000-05-25', '+60 days')
SELECT T1.c_customer_id  FROM customer AS T1  JOIN customer_address AS T2 ON T1.c_current_addr_sk = T2.ca_address_sk  JOIN household_demographics AS T3 ON T1.c_current_hdemo_sk = T3.hd_demo_sk  JOIN income_band AS T4 ON T3.hd_income_band_sk = T4.ib_income_band_sk  WHERE T2.ca_city = 'Edgewood'  AND T4.ib_lower_bound >= 38128  AND T4.ib_upper_bound <= 88128
SELECT COUNT(*)  FROM web_sales AS T1  JOIN time_dim AS T2 ON T1.ws_sold_time_sk = T2.t_time_sk  JOIN web_page AS T3 ON T1.ws_web_page_sk = T3.wp_web_page_sk  JOIN customer AS T4 ON T1.ws_customer_sk = T4.c_customer_sk  JOIN item AS T5 ON T1.ws_item_sk = T5.i_item_sk  JOIN customer_demographics AS T6 ON T4.c_current_cdemo_sk = T6.cd_demo_sk  JOIN date_dim AS T7 ON T3.wp_access_date_sk = T7.d_date_sk AND T3.wp_creation_date_sk = T7.d_date_sk  WHERE (T2.t_hour >= 8 AND T2.t_hour < 9 AND T6.cd_dep_count = 6)  AND (T3.wp_char_count >= 5000 AND T3.wp_char_count <= 5200)  UNION  SELECT COUNT(*)  FROM web_sales AS T1  JOIN time_dim AS T2 ON T1.ws_sold_time_sk = T2.t_time_sk  JOIN web_page AS T3 ON T1.ws_web_page_sk = T3.wp_web_page_sk  JOIN customer AS T4 ON T1.ws_customer_sk = T4.c_customer_sk  JOIN item AS T5 ON T1.ws_item_sk = T5.i_item_sk  JOIN customer_demographics AS T6 ON T4.c_current_cdemo_sk = T6.cd_demo_sk  JOIN date_dim AS T7 ON T3.wp_access_date_sk = T7.d_date_sk AND T3.wp_creation_date_sk = T7.d_date_sk  WHERE (T2.t_hour >= 19 AND T2.t_hour < 20 AND T6.cd_dep_count = 6)  AND (T3.wp_char_count >= 5000 AND T3.wp_char_count <= 5200)
SELECT T1.cc_call_center_id, T1.cc_manager, sum(T2.cr_return_amt) AS total_returns  FROM catalog_returns AS T2  JOIN call_center AS T1 ON T2.cr_call_center_sk = T1.cc_call_center_sk  JOIN customer AS T3 ON T2.cr_returning_customer_sk = T3.c_customer_sk  JOIN customer_demographics AS T4 ON T3.c_current_cdemo_sk = T4.cd_demo_sk  JOIN household_demographics AS T5 ON T3.c_current_hdemo_sk = T5.hd_demo_sk  JOIN customer_address AS T6 ON T3.c_current_addr_sk = T6.ca_address_sk  JOIN date_dim AS T7 ON T2.cr_returned_date_sk = T7.d_date_sk  JOIN reason AS T8 ON T2.cr_reason_sk = T8.r_reason_sk  JOIN warehouse AS T9 ON T2.cr_warehouse_sk = T9.w_warehouse_sk  JOIN ship_mode AS T10 ON T2.cr_ship_mode_sk = T10.sm_ship_mode_sk  JOIN catalog_page AS T11 ON T2.cr_catalog_page_sk = T11.cp_catalog_page_sk  WHERE T7.d_month_seq = 11  AND T7.d_year = 1998  AND (T4.cd_marital_status = 'M' OR (T4.cd_marital_status = 'W' AND T4.cd_education_status = 'Advanced Degree'))  AND T5.hd_buy_potential = 'Unknown'  AND T6.ca_gmt_offset = -7  GROUP BY T1.cc_call_center_id, T1.cc_manager  ORDER BY total_returns DESC
SELECT SUM(ws_ext_discount_amt) AS total_discount FROM web_sales JOIN item ON web_sales.ws_item_sk = item.i_item_sk JOIN date_dim ON web_sales.ws_sold_date_sk = date_dim.d_date_sk JOIN promotion ON web_sales.ws_promo_sk = promotion.p_promo_sk WHERE item.i_manufact_id = 350 AND date_dim.d_date >= '2000-01-27' AND date_dim.d_date < DATE('2000-01-27', '+90 days') AND ws_ext_discount_amt > (SELECT AVG(ws_ext_discount_amt) * 0.3 FROM web_sales WHERE item.i_manufact_id = 350 AND date_dim.d_date >= '2000-01-27' AND date_dim.d_date < DATE('2000-01-27', '+90 days')) GROUP BY item.i_item_id ORDER BY total_discount ASC
SELECT T1.ss_customer_sk, (SUM(T1.ss_ext_sales_price) - SUM(T2.sr_return_amt)) AS total_cost  FROM store_sales AS T1  JOIN store_returns AS T2 ON T1.ss_ticket_number = T2.sr_ticket_number AND T1.ss_item_sk = T2.sr_item_sk  JOIN reason AS T3 ON T2.sr_reason_sk = T3.r_reason_sk  WHERE T3.r_reason_desc = 'reason 28'  GROUP BY T1.ss_customer_sk  ORDER BY total_cost, T1.ss_customer_sk ASC
SELECT count(*) , sum(ws_ext_ship_cost) , sum(ws_net_profit)  FROM web_sales AS T1  JOIN date_dim AS T2 ON T1.ws_sold_date_sk = T2.d_date_sk  JOIN customer AS T3 ON T1.ws_bill_customer_sk = T3.c_customer_sk  JOIN web_site AS T4 ON T1.ws_web_site_sk = T4.web_site_sk  WHERE T2.d_date >= '1999-02-01' AND T2.d_date <= '1999-04-01'  AND T3.c_state = 'IL'  AND T4.web_name = 'pri'  AND T1.ws_order_number NOT IN (     SELECT ws_order_number      FROM web_sales      GROUP BY ws_order_number      HAVING count(DISTINCT ws_warehouse_sk) <= 1 )  GROUP BY T1.ws_order_number  ORDER BY count(*) ASC
SELECT count(ws_order_number) AS web_sales_count, sum(ws_ext_ship_cost) AS total_shipping_cost, sum(ws_net_profit) AS total_net_profit  FROM web_sales AS T1  JOIN web_site AS T2 ON T1.ws_web_site_sk = T2.web_site_sk  JOIN customer AS T3 ON T1.ws_ship_customer_sk = T3.c_customer_sk  JOIN customer_address AS T4 ON T1.ws_ship_addr_sk = T4.ca_address_sk  JOIN household_demographics AS T5 ON T1.ws_ship_hdemo_sk = T5.hd_demo_sk  JOIN customer_demographics AS T6 ON T1.ws_ship_cdemo_sk = T6.cd_demo_sk  JOIN date_dim AS T7 ON T1.ws_ship_date_sk = T7.d_date_sk  JOIN time_dim AS T8 ON T1.ws_sold_time_sk = T8.t_time_sk  JOIN date_dim AS T9 ON T1.ws_sold_date_sk = T9.d_date_sk  JOIN web_returns AS T10 ON T10.wr_order_number = T1.ws_order_number  AND T10.wr_reason_sk = T1.wr_reason_sk  AND T10.wr_web_page_sk = T1.wr_web_page_sk  AND T10.wr_returning_addr_sk = T1.wr_returning_addr_sk  AND T10.wr_returning_hdemo_sk = T1.wr_returning_hdemo_sk  AND T10.wr_returning_cdemo_sk = T1.wr_returning_cdemo_sk  AND T10.wr_returning_customer_sk = T1.wr_returning_customer_sk  AND T10.wr_refunded_addr_sk = T1.wr_refunded_addr_sk  AND T10.wr_refunded_hdemo_sk = T1.wr_refunded_hdemo_sk  AND T10.wr_refunded_cdemo_sk = T1.wr_refunded_cdemo_sk  AND T10.wr_refunded_customer_sk = T1.wr_refunded_customer_sk  AND T10.wr_item_sk = T1.ws_item_sk  AND T10.wr_returned_time_sk = T8.t_time_sk  AND T10.wr_returned_date_sk = T9.d_date_sk  WHERE T2.web_name = 'pri'  AND T4.ca_state = 'IL'  AND T7.d_date >= '1999-02-01'  AND T7.d_date <= '1999-04-01'  GROUP BY T1.ws_order_number  ORDER BY web_sales_count ASC
SELECT count(*) ,  T2.s_store_name  FROM store_sales AS T1  JOIN store AS T2 ON T1.ss_store_sk  =  T2.s_store_sk  JOIN customer AS T3 ON T1.ss_customer_sk  =  T3.c_customer_sk  JOIN time_dim AS T4 ON T1.ss_sold_time_sk  =  T4.t_time_sk  JOIN customer_demographics AS T5 ON T3.c_current_cdemo_sk  =  T5.cd_demo_sk  WHERE T5.cd_dep_count  =  7  AND T4.t_hour  =  20  AND T4.t_minute >= 30  AND T2.s_store_name = 'ese' GROUP BY T2.s_store_name  ORDER BY count(*) ASC
SELECT COUNT(ws_order_number) AS promotional_sales,  SUM(ws_ext_sales_price) AS total_sales,  SUM(ws_ext_sales_price) / COUNT(ws_order_number) AS sales_ratio  FROM web_sales  JOIN item ON web_sales.ws_item_sk = item.i_item_sk  JOIN date_dim ON web_sales.ws_sold_date_sk = date_dim.d_date_sk  WHERE item.i_category = 'category_name'  AND date_dim.d_month_seq BETWEEN 1200 AND 1211  AND date_dim.d_gmt_offset = 'time_zone'
SELECT T4.w_warehouse_name, T5.cc_name, T6.sm_ship_mode_id,    COUNT(CASE WHEN T2.d_month_seq BETWEEN 1200 AND 1201 THEN T1.cs_order_number END) AS "30_days",   COUNT(CASE WHEN T2.d_month_seq BETWEEN 1202 AND 1203 THEN T1.cs_order_number END) AS "31_to_60_days",   COUNT(CASE WHEN T2.d_month_seq BETWEEN 1204 AND 1205 THEN T1.cs_order_number END) AS "61_to_90_days",   COUNT(CASE WHEN T2.d_month_seq BETWEEN 1206 AND 1207 THEN T1.cs_order_number END) AS "91_to_120_days",   COUNT(CASE WHEN T2.d_month_seq > 1207 THEN T1.cs_order_number END) AS "over_120_days" FROM catalog_sales AS T1 JOIN date_dim AS T2 ON T1.cs_ship_date_sk = T2.d_date_sk JOIN warehouse AS T4 ON T1.cs_warehouse_sk = T4.w_warehouse_sk JOIN call_center AS T5 ON T1.cs_call_center_sk = T5.cc_call_center_sk JOIN ship_mode AS T6 ON T1.cs_ship_mode_sk = T6.sm_ship_mode_sk WHERE T2.d_month_seq BETWEEN 1200 AND 1211 GROUP BY T4.w_warehouse_name, T5.cc_name, T6.sm_ship_mode_id
